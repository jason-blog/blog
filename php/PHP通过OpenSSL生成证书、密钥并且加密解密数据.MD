<p>
	http://blog.csdn.net/small_rice_/article/details/45074979&nbsp;
</p>
<p>
	<br />
</p>
<p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		一、<strong>公钥</strong>加密&nbsp;<br />
假设一下，我找了两个数字，一个是1，一个是2。我喜欢2这个数字，就保留起来，不告诉你们(私钥），然后我告诉大家，1是我的公钥。
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		我有一个文件，不能让别人看，我就用1加密了。别人找到了这个文件，但是他不知道2就是解密的私钥啊，所以他解不开，只有我可以用<br />
数字2，就是我的私钥，来解密。这样我就可以保护数据了。
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		我的好朋友x用我的公钥1加密了字符a，加密后成了b，放在网上。别人偷到了这个文件，但是别人解不开，因为别人不知道2就是我的私钥，<br />
只有我才能解密，解密后就得到a。这样，我们就可以传送加密的数据了。
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<br />
&nbsp;
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		二、<strong>私钥</strong>签名<br />
如果我用私钥加密一段数据（当然只有我可以用私钥加密，因为只有我知道2是我的私钥），结果所有的人都看到我的内容了，因为他们都知<br />
道我的公钥是1，那么这种加密有什么用处呢？
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		但是我的好朋友x说有人冒充我给他发信。怎么办呢？我把我要发的信，内容是c，用我的私钥2，加密，加密后的内容是d，发给x，再告诉他<br />
解密看是不是c。他用我的公钥1解密，发现果然是c。<br />
这个时候，他会想到，能够用我的公钥解密的数据，必然是用我的私钥加的密。只有我知道我得私钥，因此他就可以确认确实是我发的东西。<br />
这样我们就能确认发送方身份了。这个过程叫做数字签名。当然具体的过程要稍微复杂一些。用私钥来加密数据，用途就是<strong>数字签名</strong>。
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		&nbsp;
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<span style="color:#FF0000;">总结：公钥和私钥是成对的，它们互相解密。</span>
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<span style="color:#FF0000;">公钥加密，私钥解密。</span>
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<span style="color:#FF0000;">私钥数字签名，公钥验证。</span>
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<br />
	</p>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		#生成证书密钥
	</p>
	<div class="dp-highlighter bg_php" style="font-family:Consolas, &quot;width:700.909px;overflow-x:auto;overflow-y:hidden;padding-top:1px;background:url(&quot;opacity:0.6;position:relative;color:#333333;white-space:normal;margin:18px 0px !important;">
		<div class="bar" style="padding-left:45px;">
			<div class="tools" style="padding:3px 8px 10px 10px;font-stretch:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;border-left:3px solid #6CE26C;">
				<b>[php]</b>&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="ViewSource" title="view plain" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="CopyToClipboard" title="copy" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">copy</a>
				<div style="position:absolute;left:530px;top:1235px;width:25px;height:14px;z-index:99;">
				</div>
</span><span data-mod="popu_169">&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="PrintSource" title="print" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">print</a></span><a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="About" title="?" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">?</a>
			</div>
		</div>
		<ol start="1" class="dp-c" style="padding:0px;border:none;position:relative;list-style-position:initial;list-style-image:initial;color:#5C5C5C;margin:0px 0px 1px 45px !important;">
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&lt;?php&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$dn</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="keyword" style="margin:0px;padding:0px;border:none;color:#006699;background-color:inherit;font-weight:bold;">array</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"countryName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'XX'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//所在国家名称&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"stateOrProvinceName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'State'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//所在省份名称&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"localityName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'SomewhereCity'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//所在城市名称&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"organizationName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'MySelf'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//注册人姓名&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"organizationalUnitName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'Whatever'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//组织名称&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"commonName"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'mySelf'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//公共名称&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"emailAddress"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&gt;&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'user@domain.com'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//邮箱&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkeypass</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'111111'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//私钥密码&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$numberofdays</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;365;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//有效时长&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$cerpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"./test.cer"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//生成证书路径&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pfxpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"./test.pfx"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//密钥文件路径&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//生成证书&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;openssl_pkey_new();&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$csr</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;openssl_csr_new(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$dn</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$sscert</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;openssl_csr_sign(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$csr</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;null,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$numberofdays</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;openssl_x509_export(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$sscert</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$csrkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//导出证书$csrkey&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;openssl_pkcs12_export(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$sscert</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privatekey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkeypass</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//导出密钥$privatekey&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//生成证书文件&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">fopen</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$cerpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"w"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;fwrite(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$csrkey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;fclose(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//生成密钥文件&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">fopen</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pfxpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"w"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;fwrite(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privatekey</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;fclose(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$fp</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;?&gt;&nbsp;&nbsp;&nbsp;</span>
			</li>
		</ol>
	</div>
<br style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;" />
<span style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">#加密解密数据</span>
	<p style="color:#333333;font-family:Arial;font-size:14px;white-space:normal;background-color:#FFFFFF;">
		<br />
	</p>
	<div class="dp-highlighter bg_php" style="font-family:Consolas, &quot;width:700.909px;overflow-x:auto;overflow-y:hidden;padding-top:1px;background:url(&quot;opacity:0.6;position:relative;color:#333333;white-space:normal;margin:18px 0px !important;">
		<div class="bar" style="padding-left:45px;">
			<div class="tools" style="padding:3px 8px 10px 10px;font-stretch:normal;font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;border-left:3px solid #6CE26C;">
				<b>[php]</b>&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="ViewSource" title="view plain" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">view plain</a><span data-mod="popu_168">&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="CopyToClipboard" title="copy" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">copy</a>
				<div style="position:absolute;left:530px;top:1959px;width:25px;height:14px;z-index:99;">
				</div>
</span><span data-mod="popu_169">&nbsp;<a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="PrintSource" title="print" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">print</a></span><a href="http://blog.csdn.net/small_rice_/article/details/45074979#" class="About" title="?" target="_blank" style="color:#A0A0A0;text-decoration-line:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;font-size:9px;">?</a>
			</div>
		</div>
		<ol start="1" class="dp-c" style="padding:0px;border:none;position:relative;list-style-position:initial;list-style-image:initial;color:#5C5C5C;margin:0px 0px 1px 45px !important;">
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&lt;?php&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkeypass</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'111111'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//私钥密码&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pfxpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"./test.pfx"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//密钥文件路径&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$priv_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">file_get_contents</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pfxpath</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//获取密钥文件内容&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$data</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">"test"</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//加密数据测试test&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//私钥加密&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">openssl_pkcs12_read(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$priv_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$certs</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkeypass</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//读取公钥、私钥&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$prikeyid</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$certs</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">[</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'pkey'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//私钥&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">openssl_sign(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$data</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$signMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$prikeyid</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,OPENSSL_ALGO_SHA1);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//注册生成加密信息&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$signMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">base64_encode</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$signMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//base64转码加密信息&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//公钥解密&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$unsignMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">=</span><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">base64_decode</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$signMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//base64解码加密信息&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">openssl_pkcs12_read(<span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$priv_key</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$certs</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$privkeypass</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//读取公钥、私钥&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pubkeyid</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$certs</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">[</span><span class="string" style="margin:0px;padding:0px;border:none;color:blue;background-color:inherit;">'cert'</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">];&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//公钥&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$res</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;openssl_verify(</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$data</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$unsignMsg</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$pubkeyid</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">);&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//验证&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="alt" style="margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;color:inherit;line-height:18px;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;"><span class="func" style="margin:0px;padding:0px;border:none;background-color:inherit;">echo</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="vars" style="margin:0px;padding:0px;border:none;color:#DD0000;background-color:inherit;">$res</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;</span><span class="comment" style="margin:0px;padding:0px;border:none;color:#008200;background-color:inherit;">//输出验证结果，1：验证成功，0：验证失败&nbsp;&nbsp;</span><span style="margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;&nbsp;</span></span>
			</li>
			<li class="" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid #6CE26C;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;line-height:18px;margin:0px !important;padding:0px 3px 0px 10px !important;list-style-position:outside !important;">
				<span style="margin:0px;padding:0px;border:none;color:black;background-color:inherit;">?&gt; &nbsp;</span>
			</li>
		</ol>
	</div>
</p>