<h1 style="margin:0px 0px 5px;font-family:&quot;font-weight:normal;line-height:1.5em;color:#333333;text-rendering:optimizeLegibility;font-size:24px;white-space:normal;">
	Ubuntu 12.04 DNS服务器的配置方法
</h1>
<div class="article_meta" style="color:#999999;padding-bottom:8px;border-bottom:1px dashed #D3D3D3;font-size:14px;font-family:&quot;white-space:normal;">
	<div style="margin-bottom:5px;">
		<span class="timestamp" style="margin-right:5px;">时间&nbsp;2015-03-23 08:40:00&nbsp;</span><span class="from" style="margin-right:5px;"><span class="icon-globe" style="font-family:FontAwesome;text-decoration:inherit;-webkit-font-smoothing:antialiased;display:inline;width:auto;height:auto;line-height:normal;vertical-align:baseline;background-image:none;background-position:0px 0px;background-repeat:repeat;margin-top:0px;margin-right:0px;"></span>&nbsp;<a class="cut cut28 from" href="http://www.tuicool.com/sites/Fn2umm" target="_blank" style="color:#333333;text-decoration:none;transition:0.25s;outline:none 0px;overflow:hidden;white-space:nowrap;word-break:keep-all;text-overflow:ellipsis;max-width:28%;display:inline;">博客园-原创精华区</a></span>
	</div>
	<div class="source">
		<span style="float:left;">原文</span>&nbsp;&nbsp;<a class="cut cut70" href="http://www.cnblogs.com/starof/p/4286268.html?utm_source=tuicool&amp;utm_medium=referral" style="color:#333333;text-decoration:none;transition:0.25s;outline:none 0px;overflow:hidden;white-space:nowrap;word-break:keep-all;text-overflow:ellipsis;max-width:69%;display:inline-block;">http://www.cnblogs.com/starof/p/4286268.html</a>
	</div>
	<div>
		<span style="margin-right:5px;">主题</span>&nbsp;<a href="http://www.tuicool.com/topics/11000111" target="_blank" style="color:#333333;text-decoration:none;transition:0.25s;outline:none 0px;">DNS服务器&nbsp;</a><a href="http://www.tuicool.com/topics/11200002" target="_blank" style="color:#333333;text-decoration:none;transition:0.25s;outline:none 0px;">Ubuntu</a>
	</div>
</div>
<div class="article_body" id="nei" style="padding:20px 5px 25px;margin-bottom:0px;overflow-x:hidden;word-break:break-all;min-height:340px;font-size:16px;line-height:1.7em;color:#333333;font-family:&quot;white-space:normal;">
	<div style="line-height:1.7em;">
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			Bind是一款开放源码的DNS服务器软件，由美国加州大学Berkeley分校开发和维护的，全名为Berkeley Internet Name Domain它是目前世界上使用最为广泛的DNS服务器软件，支持各种unix平台和windows平台。
		</p>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			一、安装bind
		</h2>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			1、检查是否已安装bind
		</h2>
<pre class="prettyprint hljs makefile" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;"><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> dpkg -l |grep bind</span></span></pre>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			2、安装bind9
		</h2>
<pre class="prettyprint hljs makefile" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;"><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> apt-get install bind9</span></span></pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			再次检查，现在已经安装成功了。
		</p>
<pre class="prettyprint hljs ruby" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:~</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> dpkg -l |grep bind</span></span> ii  bind9 <span class="hljs-number" style="color:#880000;">1</span><span class="hljs-symbol" style="color:#BC6060;">:</span><span class="hljs-number" style="color:#880000;">9.8</span>.<span class="hljs-number" style="color:#880000;">1</span>.dfsg.P1-<span class="hljs-number" style="color:#880000;">4</span>ubuntu<span class="hljs-number" style="color:#880000;">0</span>.<span class="hljs-number" style="color:#880000;">10</span> Internet Domain Name Server</pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			DNS配置文件在/etc/bind目录中，查看bind安装目录
		</p>
		<div style="line-height:1.7em;">
			<img src="http://img2.tuicool.com/7JJJry.gif" style="max-width:96%;height:auto;vertical-align:middle;border-style:none;margin:0px auto;text-align:center;" /> 
<pre class="prettyprint hljs lua" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver:/etc/bind<span style="color:#008000;">#</span><span style="color:#008000;"> ls -l</span> total <span class="hljs-number" style="color:#880000;">52</span> -rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root 2389 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> bind.keys</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root  237 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> db.0</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root  271 Feb 18 21:45 db.127</span> -rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root  237 Feb 18 21:45 db.255</span> -rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root  353 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> db.empty</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root  270 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> db.local</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root 2994 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> db.root</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root bind  463 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> named.conf</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root bind  490 Feb 18 21:45 named.conf.default-</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;">zones</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root bind  165 Feb 18 21:45</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> named.conf.local</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root bind  890 Mar 20 14:37</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> named.conf.options</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">----- 1 bind bind   77 Mar 20 14:37</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> rndc.key</span> </span>-rw-r<span class="hljs-comment" style="color:#888888;">--r-- 1 root root 1317 Feb 18 21:45 zones.rfc1918</span></pre>
View Code
		</div>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			安装bind9后会生成如下三个配置文件：named.conf，named.conf.options，named.conf.local 。
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			其中name.conf是主配置文件，里面包含了name.conf.options和named.conf.local。我们在假设本地dns时，只需要改动named.conf.local即可。
		</p>
		<div style="line-height:1.7em;">
			<img src="http://img2.tuicool.com/7JJJry.gif" style="max-width:96%;height:auto;vertical-align:middle;border-style:none;margin:0px auto;text-align:center;" /> 
<pre class="prettyprint hljs verilog" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver:/etc/<span class="hljs-keyword" style="color:#333333;font-weight:700;">bind</span><span style="color:#008000;">#</span><span style="color:#008000;"> cat named<span class="hljs-variable" style="color:#BC6060;">.conf</span></span> <span class="hljs-comment" style="color:#888888;">// This </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">is</span></span><span class="hljs-comment" style="color:#888888;"> the primary configuration file </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">for</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> the BIND DNS server named.</span> </span><span class="hljs-comment" style="color:#888888;">//</span> <span class="hljs-comment" style="color:#888888;">// Please read /usr/share/doc/bind9/README.Debian.gz </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">for</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> information on the </span> </span><span class="hljs-comment" style="color:#888888;">// structure of BIND configuration files </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">in</span></span><span class="hljs-comment" style="color:#888888;"> Debian, *BEFORE*</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> you customize </span> </span><span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> this configuration file.</span> </span><span class="hljs-comment" style="color:#888888;">//</span> <span class="hljs-comment" style="color:#888888;">// If you are just adding zones, please do that </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">in</span></span><span class="hljs-comment" style="color:#888888;"> /etc/bind/</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;">named.conf.local</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">include</span> </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/etc/bind/named.conf.options</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">; <span class="hljs-keyword" style="color:#333333;font-weight:700;">include</span> </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/etc/bind/named.conf.local</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">; <span class="hljs-keyword" style="color:#333333;font-weight:700;">include</span> </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/etc/bind/named.conf.default-zones</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span>;</pre>
View Code
		</div>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			3、name.conf.options配置
		</h2>
		<div style="line-height:1.7em;">
			<img src="http://img2.tuicool.com/7JJJry.gif" style="max-width:96%;height:auto;vertical-align:middle;border-style:none;margin:0px auto;text-align:center;" /> 
<pre class="prettyprint hljs gradle" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver:<span class="hljs-regexp" style="color:#BC6060;">/etc/</span>bind<span style="color:#008000;">#</span><span style="color:#008000;"> cat named.conf.<span class="hljs-keyword" style="color:#333333;font-weight:700;">options</span></span> <span style="color:#000000;"><span class="hljs-keyword" style="color:#333333;font-weight:700;">options</span> {
	directory </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/var/cache/bind</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">; </span><span class="hljs-comment" style="color:#888888;">// If there </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">is</span></span><span class="hljs-comment" style="color:#888888;"> a firewall between you </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">and</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> nameservers you want</span> </span><span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> to talk to, you may need to fix the firewall to allow multiple</span> </span><span class="hljs-comment" style="color:#888888;">// ports to talk.  See http://www.kb.cert.org/vuls/id/800113</span> <span class="hljs-comment" style="color:#888888;">// If your ISP provided one </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">or</span></span><span class="hljs-comment" style="color:#888888;"> more IP addresses </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">for</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> stable </span> </span><span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> nameservers, you probably want to use them as forwarders. </span> </span><span class="hljs-comment" style="color:#888888;">// Uncomment the following block, </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">and</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> insert the addresses replacing </span> </span><span class="hljs-comment" style="color:#888888;">// the all-0</span><span style="color:#800000;"><span class="hljs-comment" style="color:#888888;">'</span></span><span style="color:#800000;"><span class="hljs-comment" style="color:#888888;">s placeholder.</span></span> <span style="color:#000000;"> forwarders { </span><span class="hljs-number" style="color:#880000;">8.8</span>.<span class="hljs-number" style="color:#880000;">8.8</span><span style="color:#000000;">; </span><span class="hljs-number" style="color:#880000;">8.8</span>.<span class="hljs-number" style="color:#880000;">4.4</span><span style="color:#000000;">; </span><span class="hljs-number" style="color:#880000;">0.0</span>.<span class="hljs-number" style="color:#880000;">0.0</span><span style="color:#000000;">;
	 }; </span><span class="hljs-comment" style="color:#888888;">//========================================================================</span> <span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> If BIND logs error messages about the root key being expired,</span> </span><span class="hljs-comment" style="color:#888888;">// you will need to update your keys.  See https://www.isc.org/bind-</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;">keys</span> </span><span class="hljs-comment" style="color:#888888;">//========================================================================</span><span style="color:#000000;"> dnssec</span>-<span style="color:#000000;">validation auto;
	auth</span>-nxdomain no; <span style="color:#008000;">#</span><span style="color:#008000;"> conform to RFC1035</span> listen-on-<span style="color:#000000;">v6 { <span class="hljs-keyword" style="color:#333333;font-weight:700;">any</span>; };
};</span> </pre>
View Code
		</div>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			该配置文件用来设置bind的forwards 地址。当bind遇到不能解析的IP地址时，它会交给forwards address DNS去处理。
		</p>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			二、环境和需求
		</h2>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			Server的ip：10.1.101.188
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			Client的ip范围为10.1.101.1——10.1.101.254相互能Ping通。
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			现在将Server架设成主dns服务器，任务的需求是能解析
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			master.lxy.com 10.1.101.11
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			www.lxy.com 10.1.101.11
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			slave1.lxy.com 10.1.101.12
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			slave2.lxy.com 10.1.101.15
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			分析：根据上面的主机名和对应ip可以看出：
		</p>
		<ul style="padding:0px;margin:0px 0px 0.75em 25px;list-style-type:none;line-height:1.7em;">
			<li style="line-height:1.7em;list-style-type:disc;">
				需要添加正向区域"lxy.com"和反向区域"101.1.&nbsp;<strong>10</strong>&nbsp;.in-addr.arpa".
			</li>
			<li style="line-height:1.7em;list-style-type:disc;">
				在"lxy.com"区域中添加A记录master对应10.1.101.11,CNAME（别名记录）记录www对应master
			</li>
			<li style="line-height:1.7em;list-style-type:disc;">
				在"101.1.&nbsp;<strong>10</strong>&nbsp;.in-addr.arpa"区域中添加各个ip地址对应的主机名
			</li>
		</ul>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			三、配置
		</h2>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			1、编辑name.conf.local
		</h2>
<pre class="prettyprint hljs scala" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root<span class="hljs-meta" style="color:#1F7199;">@nfsserver</span>:/etc/bind<span style="color:#008000;">#</span><span style="color:#008000;"> cat named.conf.local </span> <span class="hljs-comment" style="color:#888888;">//</span> <span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> Do any local configuration here</span> </span><span class="hljs-comment" style="color:#888888;">//</span> <span class="hljs-comment" style="color:#888888;">// Consider adding the 1918 zones here, </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">if</span></span><span class="hljs-comment" style="color:#888888;"> they are </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">not</span></span><span class="hljs-comment" style="color:#888888;"> used </span><span style="color:#0000FF;"><span class="hljs-comment" style="color:#888888;">in</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> your</span> </span><span class="hljs-comment" style="color:#888888;">//</span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;"> organization</span> </span><span class="hljs-comment" style="color:#888888;">//include </span><span style="color:#800000;"><span class="hljs-comment" style="color:#888888;">"</span></span><span style="color:#800000;"><span class="hljs-comment" style="color:#888888;">/etc/bind/zones.rfc1918</span></span><span style="color:#800000;"><span class="hljs-comment" style="color:#888888;">"</span></span><span style="color:#000000;"><span class="hljs-comment" style="color:#888888;">;</span> </span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">//</span></span><span style="color:#000000;"><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">正向解析域</span></span> zone </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">lxy.com</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">{ <span class="hljs-class"><span class="hljs-keyword" style="color:#333333;font-weight:700;">type</span> <span class="hljs-title" style="color:#880000;font-weight:bold;">master</span></span>; <span style="color:#008000;">#定义<span class="hljs-type" style="color:#880000;">DNS</span>服务器为主<span class="hljs-type" style="color:#880000;">DNS</span></span> file </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/etc/bind/db.lxy.com</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">;
}; <span style="color:#008000;"># <span class="hljs-type" style="color:#880000;">For</span> reverse <span class="hljs-type" style="color:#880000;">DNS</span></span> </span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">//</span></span><span style="color:#000000;"><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">反向解析域</span></span> zone </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">101.1.10.in-addr.arpa</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">{ <span class="hljs-class"><span class="hljs-keyword" style="color:#333333;font-weight:700;">type</span> <span class="hljs-title" style="color:#880000;font-weight:bold;">master</span></span>;
notify no;
file </span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">/etc/bind/rev.101.1.10.in-addr.arpa.</span></span><span style="color:#800000;"><span class="hljs-string" style="color:#880000;">"</span></span><span style="color:#000000;">;
};</span></pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			反解析zone名称定义规定前部分ip倒着写。如ip 192.168.1.2,名称定义为1.168.192.in-addr.arpa。
		</p>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			2、新建name.conf.local中指定的区域文件
		</h2>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			在/etc/bind下新建正向区域文件（复制一份）
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			命令：&nbsp;#&nbsp;cp /etc/bind/db.local /etc/bind/db.lxy.com
		</p>
<pre class="prettyprint hljs ruby" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> cp db.local db.lxy.com</span></span> root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> ls</span></span> bind.keys  db.<span class="hljs-number" style="color:#880000;">127</span><span style="color:#000000;"> db.empty  db.lxy.com  named.conf                named.conf.local    rndc.key
db.<span class="hljs-number" style="color:#880000;">0</span> db.</span><span class="hljs-number" style="color:#880000;">255</span> db.local  db.root     named.conf.default-<span style="color:#000000;">zones  named.conf.options  zones.rfc1918
root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:</span></span><span class="hljs-symbol" style="color:#BC6060;">/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span></pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			在/etc/bind下新建反向区域文件（复制一份）
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			命令：&nbsp;cp /etc/bind/db.127 /etc/bind/rev.101.1.10.in-addr.arpa
		</p>
<pre class="prettyprint hljs ruby" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> cp db.127 rev.101.1.10.in-addr.arpa</span></span> root@nfsserver<span class="hljs-symbol" style="color:#BC6060;">:/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> ls</span></span> bind.keys  db.<span class="hljs-number" style="color:#880000;">127</span> db.empty  db.lxy.com  named.conf                named.conf.local    rev.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;"><span class="hljs-keyword" style="color:#333333;font-weight:700;">in</span></span>-<span style="color:#000000;">addr.arpa  zones.rfc1918
db.<span class="hljs-number" style="color:#880000;">0</span> db.</span><span class="hljs-number" style="color:#880000;">255</span> db.local  db.root     named.conf.default-zones  named.conf.options  rndc.key</pre>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			3、编辑正向解析域文件
		</h2>
<pre class="prettyprint hljs powershell" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver:/etc/bind<span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> cat db.lxy.com </span></span> <span style="color:#000000;">;
; BIND <span class="hljs-keyword" style="color:#333333;font-weight:700;">data</span> file </span><span style="color:#0000FF;"><span class="hljs-keyword" style="color:#333333;font-weight:700;">for</span></span><span style="color:#000000;"> local loopback interface
; <span class="hljs-variable" style="color:#BC6060;">$TTL</span> </span><span class="hljs-number" style="color:#880000;">604800</span><span style="color:#000000;"> @ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> SOA     localhost. root.localhost. ( </span><span class="hljs-number" style="color:#880000;">2</span><span style="color:#000000;"> ; Serial </span><span class="hljs-number" style="color:#880000;">604800</span><span style="color:#000000;"> ; Refresh </span><span class="hljs-number" style="color:#880000;">86400</span><span style="color:#000000;"> ; Retry </span><span class="hljs-number" style="color:#880000;">2419200</span><span style="color:#000000;"> ; Expire </span><span class="hljs-number" style="color:#880000;">604800</span><span style="color:#000000;"> )       ; Negative Cache TTL
;
@ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> NS      localhost.
@ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> A </span><span class="hljs-number" style="color:#880000;">127.0</span>.<span class="hljs-number" style="color:#880000;">0.1</span><span style="color:#000000;"> @ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> AAAA    ::</span><span class="hljs-number" style="color:#880000;">1</span><span style="color:#000000;"> master <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> A </span><span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span><span style="color:#000000;"> www <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> CNAME   master
slave1 <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> A </span><span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span><span style="color:#000000;"> slave2 <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> A </span><span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span></pre>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			4、编辑反向解析域文件
		</h2>
<pre class="prettyprint hljs powershell" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsserver:/etc/bind<span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> cat rev.101.1.10.in-addr.arpa</span></span> <span style="color:#000000;">;
; BIND reverse <span class="hljs-keyword" style="color:#333333;font-weight:700;">data</span> file </span><span style="color:#0000FF;"><span class="hljs-keyword" style="color:#333333;font-weight:700;">for</span></span><span style="color:#000000;"> local loopback interface
; <span class="hljs-variable" style="color:#BC6060;">$TTL</span> </span><span class="hljs-number" style="color:#880000;">604800</span> <span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#指示为每个没有特殊TTL设置的RR给出了一个默认的TTL。</span></span><span style="color:#000000;"> @ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> SOA     localhost. root.localhost. ( <span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#定义SOA记录，包括Zone的名字，一个技术联系人和各种不同的超时值。</span> </span></span><span class="hljs-number" style="color:#880000;">1</span><span style="color:#000000;"> ; Serial </span><span class="hljs-number" style="color:#880000;">604800</span><span style="color:#000000;"> ; Refresh </span><span class="hljs-number" style="color:#880000;">86400</span><span style="color:#000000;"> ; Retry </span><span class="hljs-number" style="color:#880000;">2419200</span><span style="color:#000000;"> ; Expire </span><span class="hljs-number" style="color:#880000;">604800</span><span style="color:#000000;"> )       ; Negative Cache TTL
;
@ <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> NS      localhost. </span><span class="hljs-number" style="color:#880000;">1.0</span><span style="color:#000000;">.<span class="hljs-number" style="color:#880000;">0</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> PTR     localhost. </span><span class="hljs-number" style="color:#880000;">11</span><span style="color:#000000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> PTR     master.lxy.com </span><span class="hljs-number" style="color:#880000;">11</span><span style="color:#000000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> PTR     www.lxy.com </span><span class="hljs-number" style="color:#880000;">12</span><span style="color:#000000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> PTR     slave1.lxy.com </span><span class="hljs-number" style="color:#880000;">15</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">IN</span> PTR     slave2.lxy.com</pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			反解析域可以不设置。
		</p>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			5、重启DNS服务
		</h2>
<pre class="prettyprint hljs makefile" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;"><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> service bind9 restart</span> <span style="color:#000000;"><span class="hljs-comment" style="color:#888888;">或者</span></span> <span class="hljs-comment" style="color:#888888;"># /etc/init.d/bind9 restart</span></span></pre>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			四、指定Linux系统使用DNS服务
		</h2>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			现在我在10.1.101.189中配置DNS为刚才配置的10.1.101.188。
		</p>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			有一点需要注意不要在/etc/resolv.conf中去修改DNS，重启网络后配置就丢失了。
		</p>
<pre class="prettyprint hljs delphi" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsclient:~<span style="color:#008000;">#</span><span style="color:#008000;"> cat /etc/resolv.conf </span><span style="color:#008000;"> #</span><span style="color:#008000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">Dynamic</span> resolv.conf(<span class="hljs-number" style="color:#880000;">5</span>) <span class="hljs-keyword" style="color:#333333;font-weight:700;">file</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">for</span> glibc resolver(<span class="hljs-number" style="color:#880000;">3</span>) generated by resolvconf(<span class="hljs-number" style="color:#880000;">8</span>)</span><span style="color:#008000;"> #</span><span style="color:#008000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">DO</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">NOT</span> EDIT THIS <span class="hljs-keyword" style="color:#333333;font-weight:700;">FILE</span> BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span> nameserver <span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.188</span></pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			在/etc/network/interface中设置DNS
		</p>
<pre class="prettyprint hljs vim" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span>~<span style="color:#008000;">#</span><span style="color:#008000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">cat</span> /etc/network/interfaces </span><span style="color:#008000;"> #</span><span style="color:#008000;"> This <span class="hljs-keyword" style="color:#333333;font-weight:700;">file</span> describes the network interfaces available <span class="hljs-keyword" style="color:#333333;font-weight:700;">on</span> your <span class="hljs-built_in" style="color:#397300;">system</span></span><span style="color:#008000;"> #</span><span style="color:#008000;"> <span class="hljs-built_in" style="color:#397300;">and</span> how <span class="hljs-keyword" style="color:#333333;font-weight:700;">to</span> activate them. For more information, see interfaces(<span class="hljs-number" style="color:#880000;">5</span>).</span> <span style="color:#008000;">#</span><span style="color:#008000;"> The loopback network interface</span> <span style="color:#000000;">auto <span class="hljs-keyword" style="color:#333333;font-weight:700;">lo</span> iface <span class="hljs-keyword" style="color:#333333;font-weight:700;">lo</span> inet loopback

auto eth0
iface eth0 inet static
address </span><span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.189</span><span style="color:#000000;"> netmask </span><span class="hljs-number" style="color:#880000;">255.255</span>.<span class="hljs-number" style="color:#880000;">255.0</span><span style="color:#000000;"> gateway </span><span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.254</span><span style="color:#000000;"> dns</span>-nameservers <span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.188</span></pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			重启网络，然后就可以ping通刚才配置的域名了。
		</p>
<pre class="prettyprint hljs vim" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span>~<span style="color:#008000;">#</span><span style="color:#008000;"> <span class="hljs-keyword" style="color:#333333;font-weight:700;">cat</span> /etc/resolv.<span class="hljs-keyword" style="color:#333333;font-weight:700;">conf</span> </span><span style="color:#008000;"> #</span><span style="color:#008000;"> Dynamic resolv.<span class="hljs-keyword" style="color:#333333;font-weight:700;">conf</span>(<span class="hljs-number" style="color:#880000;">5</span>) <span class="hljs-keyword" style="color:#333333;font-weight:700;">file</span> <span class="hljs-keyword" style="color:#333333;font-weight:700;">for</span> glibc resolver(<span class="hljs-number" style="color:#880000;">3</span>) generated by resolvconf(<span class="hljs-number" style="color:#880000;">8</span>)</span><span style="color:#008000;"> #</span><span style="color:#008000;"> DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span> nameserver <span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.188</span><span style="color:#000000;"> root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span></span>~<span style="color:#008000;">#</span><span style="color:#008000;"> ping -<span class="hljs-keyword" style="color:#333333;font-weight:700;">c</span> <span class="hljs-number" style="color:#880000;">4</span> master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span></span> PING master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>) <span class="hljs-number" style="color:#880000;">56</span>(<span class="hljs-number" style="color:#880000;">84</span><span style="color:#000000;">) bytes of data. </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> www.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">1</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.978</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">2</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.626</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> www.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">3</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.628</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">4</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.591</span><span style="color:#000000;"> ms </span>--- master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> ping statistics --- <span class="hljs-number" style="color:#880000;">4</span> packets transmitted, <span class="hljs-number" style="color:#880000;">4</span> received, <span class="hljs-number" style="color:#880000;">0</span>%<span style="color:#000000;"> packet loss, time <span class="hljs-number" style="color:#880000;">3005</span>ms
rtt <span class="hljs-built_in" style="color:#397300;">min</span></span>/avg/<span class="hljs-built_in" style="color:#397300;">max</span>/mdev = <span class="hljs-number" style="color:#880000;">0.591</span>/<span class="hljs-number" style="color:#880000;">0.705</span>/<span class="hljs-number" style="color:#880000;">0.978</span>/<span class="hljs-number" style="color:#880000;">0.161</span><span style="color:#000000;"> ms
root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span></span>~<span style="color:#008000;">#</span><span style="color:#008000;"> ping -<span class="hljs-keyword" style="color:#333333;font-weight:700;">c</span> <span class="hljs-number" style="color:#880000;">4</span> www.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span></span> PING master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>) <span class="hljs-number" style="color:#880000;">56</span>(<span class="hljs-number" style="color:#880000;">84</span><span style="color:#000000;">) bytes of data. </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> www.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">1</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">1.06</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">2</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.655</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> www.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">3</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.556</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.11</span>): icmp_req=<span class="hljs-number" style="color:#880000;">4</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.577</span><span style="color:#000000;"> ms </span>--- master.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> ping statistics --- <span class="hljs-number" style="color:#880000;">4</span> packets transmitted, <span class="hljs-number" style="color:#880000;">4</span> received, <span class="hljs-number" style="color:#880000;">0</span>%<span style="color:#000000;"> packet loss, time <span class="hljs-number" style="color:#880000;">3004</span>ms
rtt <span class="hljs-built_in" style="color:#397300;">min</span></span>/avg/<span class="hljs-built_in" style="color:#397300;">max</span>/mdev = <span class="hljs-number" style="color:#880000;">0.556</span>/<span class="hljs-number" style="color:#880000;">0.714</span>/<span class="hljs-number" style="color:#880000;">1.068</span>/<span class="hljs-number" style="color:#880000;">0.207</span><span style="color:#000000;"> ms
root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span></span>~<span style="color:#008000;">#</span><span style="color:#008000;"> ping -<span class="hljs-keyword" style="color:#333333;font-weight:700;">c</span> <span class="hljs-number" style="color:#880000;">4</span> slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span></span> PING slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span>) <span class="hljs-number" style="color:#880000;">56</span>(<span class="hljs-number" style="color:#880000;">84</span><span style="color:#000000;">) bytes of data. </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span>): icmp_req=<span class="hljs-number" style="color:#880000;">1</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">1.07</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span>): icmp_req=<span class="hljs-number" style="color:#880000;">2</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.352</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span>): icmp_req=<span class="hljs-number" style="color:#880000;">3</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.346</span><span style="color:#000000;"> ms </span><span class="hljs-number" style="color:#880000;">64</span> bytes <span style="color:#0000FF;">from</span> slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.<span style="color:#0000FF;">in</span>-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.12</span>): icmp_req=<span class="hljs-number" style="color:#880000;">4</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">0.321</span><span style="color:#000000;"> ms </span>--- slave1.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> ping statistics --- <span class="hljs-number" style="color:#880000;">4</span> packets transmitted, <span class="hljs-number" style="color:#880000;">4</span> received, <span class="hljs-number" style="color:#880000;">0</span>%<span style="color:#000000;"> packet loss, time <span class="hljs-number" style="color:#880000;">3004</span>ms
rtt <span class="hljs-built_in" style="color:#397300;">min</span></span>/avg/<span class="hljs-built_in" style="color:#397300;">max</span>/mdev = <span class="hljs-number" style="color:#880000;">0.321</span>/<span class="hljs-number" style="color:#880000;">0.523</span>/<span class="hljs-number" style="color:#880000;">1.075</span>/<span class="hljs-number" style="color:#880000;">0.319</span> ms
root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span>~<span style="color:#008000;"># ping -<span class="hljs-keyword" style="color:#333333;font-weight:700;">c</span> <span class="hljs-number" style="color:#880000;">4</span> slave2.lxy.com</span> PING slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span>) <span class="hljs-number" style="color:#880000;">56</span>(<span class="hljs-number" style="color:#880000;">84</span>) bytes of data. <span class="hljs-number" style="color:#880000;">64</span> bytes from slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.in-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span>): icmp_req=<span class="hljs-number" style="color:#880000;">1</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">3.69</span> ms
64 bytes from slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.in-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span>): icmp_req=<span class="hljs-number" style="color:#880000;">2</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">1.63</span> ms
64 bytes from slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.in-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span>): icmp_req=<span class="hljs-number" style="color:#880000;">3</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">1.59</span> ms
64 bytes from slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span>.<span class="hljs-number" style="color:#880000;">101.1</span>.<span class="hljs-number" style="color:#880000;">10</span>.in-addr.arpa (<span class="hljs-number" style="color:#880000;">10.1</span>.<span class="hljs-number" style="color:#880000;">101.15</span>): icmp_req=<span class="hljs-number" style="color:#880000;">4</span> ttl=<span class="hljs-number" style="color:#880000;">64</span> time=<span class="hljs-number" style="color:#880000;">1.56</span> ms
--- slave2.lxy.<span class="hljs-keyword" style="color:#333333;font-weight:700;">com</span> ping statistics --- <span class="hljs-number" style="color:#880000;">4</span> packets transmitted, <span class="hljs-number" style="color:#880000;">4</span> received, <span class="hljs-number" style="color:#880000;">0</span>% packet loss, time <span class="hljs-number" style="color:#880000;">3005</span>ms
rtt <span class="hljs-built_in" style="color:#397300;">min</span>/avg/<span class="hljs-built_in" style="color:#397300;">max</span>/mdev = <span class="hljs-number" style="color:#880000;">1.566</span>/<span class="hljs-number" style="color:#880000;">2.122</span>/<span class="hljs-number" style="color:#880000;">3.696</span>/<span class="hljs-number" style="color:#880000;">0.909</span> ms
root@nfsclien<span class="hljs-variable" style="color:#BC6060;">t:</span>~#</pre>
		<h2 style="margin:0px 0px 0.5em;font-family:inherit;line-height:1.6em;color:inherit;text-rendering:optimizeLegibility;font-size:18px;text-indent:1em;">
			五、常见错误处理
		</h2>
<pre class="prettyprint hljs ruby" style="padding:0.5em;font-family:Menlo, Monaco, Consolas, &quot;color:#444444;border-radius:4px;margin-top:0px;margin-bottom:1.5em;font-size:14px;line-height:1.5em;word-break:break-all;word-wrap:break-word;background-color:#F6F6F6;border:none;overflow-x:auto;">root@dns<span class="hljs-symbol" style="color:#BC6060;">:/etc/bind</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;"> /etc/init.d/bind9 restart</span></span> * Stopping domain name service... bind9 <span class="hljs-symbol" style="color:#BC6060;">rndc:</span> connect <span class="hljs-symbol" style="color:#BC6060;">failed:</span> <span class="hljs-number" style="color:#880000;">127.0</span>.<span class="hljs-number" style="color:#880000;">0</span>.<span class="hljs-number" style="color:#880000;">1</span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">#</span></span><span style="color:#008000;"><span class="hljs-comment" style="color:#888888;">953: connection refused</span></span> <span style="color:#000000;"> [ OK ] </span>* Starting domain name service... bind9                                                              [<span style="color:#FF0000;">fail</span>]</pre>
		<p style="margin-top:0px;margin-bottom:0.75em;line-height:1.7em;text-indent:1em;">
			原因是在name.conf.local中配置了两个相同的www.teststack.com，删除多余的一条域名记录，然后就可以重启了。
		</p>
	</div>
</div>